# GEMINI.md: 2人対戦スネークゲーム プロジェクト

## 1. 概要

本プロジェクトは、ブラウザ上で2人が対戦できるリアルタイムスネークゲームを開発することを目的とします。UIはドット調でシンプルかつ楽しい雰囲気を重視し、操作はマス目に縛られない滑らかな動きを目指します。プレイヤーはそれぞれのスネークを操作し、フィールド上の餌を食べさせて長く成長させながら、相手プレイヤーとの勝利を目指します。

## 2. 要件定義

### 機能要件

-   **ゲーム画面**
    -   黒い背景のゲームフィールド（盤面）が表示されること。
    -   フィールドは上下左右を四角い壁で囲まれていること。
    -   2人分のスネークがリアルタイムに表示されること。
    -   フィールド上にランダムな位置で餌が出現すること。
    -   各プレイヤーのスコア（現在のスネークの長さ）が画面上部に表示されること。

-   **プレイヤー操作**
    -   キーボードの矢印キー（↑、↓、←、→）およびWASDキーで、マス目に縛られず自由に角度を変えながらスネークを滑らかに操作できること。

-   **ゲームルール**
    -   餌を食べるとスネークが長くなること。
    -   餌を食べるとスコアが加算されること。
    -   自分のスネークが壁、または自分自身・相手のスネークの体に衝突するとゲームオーバーになること。
    -   相手が先にゲームオーバーになったプレイヤーが勝者となること。

-   **ゲームフロー**
    -   **開始**: USERとENEMYの両プレイヤーが「スタート」ボタンを押すとゲームが開始されること。
    -   **終了**: ゲームオーバーになると、リザルト画面に遷移すること。
    -   **リザルト画面**: リザルト画面では、30秒後に「再マッチ」か「メインメニューへ戻る」かを選択できること。

-   **UI/UX**
    -   UIは極力シンプルかつ、ドット調で楽しい雰囲気であること。
    -   特にゲームオーバー時には、ドット調で派手な演出を表示すること。

### 非機能要件

-   **プラットフォーム**
    -   モダンなウェブブラウザ（Chrome, Firefox, Safari, Edge）で特別なプラグインなしに動作すること。
-   **コード品質**
    -   コードベースはカスタマイズ性と保守性を担保する構造であること。

## 3. 技術スタック

-   **言語:** HTML5, CSS3, JavaScript (ES6+)
-   **フレームワーク:** 使用しない
-   **描画:** HTML5 Canvas API を使用し、ゲーム画面を動的に描画する。

## 4. アーキテクチャ概要

-   **クライアントサイドアーキテクチャ**を採用します。
-   ゲームロジック、描画、入力処理のすべてをブラウザ上で完結させます。
-   コードは役割（描画、ゲームロジック、入力ハンドリングなど）ごとにモジュール化し、保守性を高めます。

## 5. 開発計画（ステップ）

1.  **ステップ1: 画面の骨格作成**
    -   HTMLでメインメニュー（スタートボタン）、ゲーム画面（Canvas）、リザルト画面の各要素を配置します。
    -   CSSで基本的なレイアウトと、黒背景・ドット調の雰囲気のスタイリングを適用します。
2.  **ステップ2: ゲームのコアロジック実装**
    -   JavaScriptでCanvasへの描画機能（スネーク、餌、壁）を実装します。
    -   1P側のスネークを、マス目に縛られない滑らかな操作で動かせるようにします。
    -   衝突判定（壁、自分自身）のロジックを実装します。
3.  **ステップ3: 2人対戦機能とゲームフローの実装**
    -   2P側のスネークを追加し、WASDキーで操作できるようにします。
    -   プレイヤー間の衝突判定を実装します。
    -   スコア表示や勝敗判定のロジックを追加します。
    -   メインメニューの「スタート」ボタン（両者押下で開始）ロジックを実装します。
4.  **ステップ4: 仕上げと演出強化**
    -   リザルト画面を実装し、30秒後の選択（再マッチ/メインメニュー）機能を実装します。
    -   ゲームオーバー時に、ドット調で派手な演出を追加します。
    -   全体的なデザインを整え、楽しい雰囲気を完成させます。

